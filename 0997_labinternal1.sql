CREATE TABLE DVDRENTALS (MEMBERID INT PRIMARY KEY, MEMBERNAME VARCHAR2(25), MOBILE INT);

CREATE TABLE DVD (DVDID INT PRIMARY KEY, TITLE VARCHAR2(15), CATEGORY VARCHAR2(15), COST INT);

CREATE TABLE DVDISSUE (MEMBERID INT, DVDID INT, ISSUEDATE DATE, PRIMARY KEY (MEMBERID, DVDID), FOREIGN KEY (MEMBERID) REFERENCES DVDRENTALS(MEMBERID), FOREIGN KEY (DVDID) REFERENCES DVD(DVDID));

INSERT INTO DVDRENTALS VALUES (1, 'Raghunath Reddy', 7867654875);
INSERT INTO DVDRENTALS VALUES (2, 'Abhishek Varma', 9867654877);
INSERT INTO DVDRENTALS VALUES (3, 'Kunal Singh', 8867644879);
INSERT INTO DVDRENTALS VALUES (4, 'Mahendra Singh', 9867564975);
INSERT INTO DVDRENTALS VALUES (5, 'Surendra Patel', 8867654777);
INSERT INTO DVDRENTALS VALUES (6, 'Sharukh Joshi', 8867564975);

INSERT INTO DVD VALUES (1, 'Kati Patang', 'Love Story', 499);
INSERT INTO DVD VALUES (2, 'Kashmir Ki Kali', 'Love Story', 599);
INSERT INTO DVD VALUES (3, 'Gol Maal', 'Comedy', 600);
INSERT INTO DVD VALUES (4, 'Gambler', 'Action', 250);
INSERT INTO DVD VALUES (5, 'Ek Tha Tiger', 'Action', 500);
INSERT INTO DVD VALUES (6, 'Singh Is King', 'Action', 599);
INSERT INTO DVD VALUES (7, 'House No. 13', 'Horror', 200);
INSERT INTO DVD VALUES (8, 'Krish', 'Action', 489);

INSERT INTO DVDISSUE VALUES (1, 1, '01-04-2011');
INSERT INTO DVDISSUE VALUES (1, 2, '01-05-2012');
INSERT INTO DVDISSUE VALUES (2, 4, '01-06-2010');
INSERT INTO DVDISSUE VALUES (2, 5, '01-01-2011');
INSERT INTO DVDISSUE VALUES (3, 6, '01-02-2010');
INSERT INTO DVDISSUE VALUES (4, 8, '01-03-2010');
INSERT INTO DVDISSUE VALUES (5, 7, '01-04-2010');
INSERT INTO DVDISSUE VALUES (6, 2, '01-05-2012');
INSERT INTO DVDISSUE VALUES (1, 4, '01-06-2011');
INSERT INTO DVDISSUE VALUES (4, 3, '01-12-2010');

SELECT * FROM DVDRENTALS;
SELECT * FROM DVD;
SELECT * FROM DVDISSUE;

SELECT TITLE FROM DVD WHERE COST > 250;

SELECT DISTINCT R.MEMBERNAME FROM DVDRENTALS R, DVDISSUE I WHERE R.MEMBERID = I.MEMBERID AND I.ISSUEDATE > '2010-01-01';

SELECT DISTINCT R.MEMBERNAME FROM DVDRENTALS R, DVDISSUE I, DVD D WHERE R.MEMBERID = I.MEMBERID AND I.DVDID = D.DVDID AND D.CATEGORY = 'Horror';

SELECT R.MEMBERNAME FROM DVDRENTALS R, DVDISSUE I WHERE R.MEMBERID = I.MEMBERID GROUP BY R.MEMBERNAME HAVING COUNT(I.DVDID) > 1;

CREATE VIEW V1 AS SELECT I.MEMBERID, D.TITLE FROM DVDISSUE I, DVD D WHERE I.DVDID = D.DVDID;

SELECT * FROM V1;

